(()=>{"use strict";class t{constructor(t){this.mGL=null,this.gEngine=t}getGL(){return this.mGL}_initializeWebGL(t,e="640",i="480"){var s=document.getElementById(t);s.width=e,s.height=i,this.mGL=s.getContext("webgl",{alpha:!1})||s.getContext("experimental-webgl",{alpha:!1}),this.mGL.blendFunc(this.mGL.SRC_ALPHA,this.mGL.ONE_MINUS_SRC_ALPHA),this.mGL.enable(this.mGL.BLEND),this.mGL.pixelStorei(this.mGL.UNPACK_FLIP_Y_WEBGL,!0),null!==this.mGL||document.write("<br><b>WebGL is not supported!</b>")}startScene(t){t.loadScene.call(t),this.gEngine.GameLoop.start(t)}initializeEngineCore(t,e,i="640",s="480"){this._initializeWebGL(t,i,s),this.gEngine.VertexBuffer.initialize(),this.gEngine.Input.initialize(t),this.gEngine.AudioClips.initAudioContext(),this.gEngine.DefaultResources.initialize((()=>{this.startScene(e)}))}clearCanvas(t){this.mGL.clearColor(t[0],t[1],t[2],t[3]),this.mGL.clear(this.mGL.COLOR_BUFFER_BIT)}cleanUp(){this.gEngine.DefaultResources.cleanUp(),this.gEngine.VertexBuffer.cleanUp()}}class e{constructor(t){this.mSquareVertexBuffer=null,this.mTextureCoordBuffer=null,this.gEngine=t,this.verticesOfSquare=[.5,.5,0,-.5,.5,0,.5,-.5,0,-.5,-.5,0],this.textureCoordinates=[1,1,0,1,1,0,0,0]}initialize(){this.gl=this.gEngine.Core.getGL(),this.mSquareVertexBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.mSquareVertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.verticesOfSquare),this.gl.STATIC_DRAW),this.mTextureCoordBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.mTextureCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.textureCoordinates),this.gl.STATIC_DRAW)}getGLVertexRef(){return this.mSquareVertexBuffer}getGLTexCoordRef(){return this.mTextureCoordBuffer}cleanUp(){var t=this.gEngine.Core.getGL();t.deleteBuffer(mSquareVertexBuffer),t.deleteBuffer(mTextureCoordBuffer)}}class i{constructor(t){this.gEngine=t,this.kFPS=60,this.kMPF=1e3/this.kFPS,this.mPreviousTime=Date.now(),this.mLagTime,this.mIsLoopRunning=!1,this.mMyGame=null}_runLoop(){if(this.mIsLoopRunning){window.requestAnimationFrame((()=>this._runLoop()));let t=Date.now(),e=t-this.mPreviousTime;for(this.mPreviousTime=t,this.mLagTime+=e;this.mLagTime>=this.kMPF&&this.mIsLoopRunning;)this.gEngine.Input.update(),this.mMyGame.update(),this.mLagTime-=this.kMPF;this.mMyGame.draw()}else this.mMyGame.unloadScene()}_startLoop(){this.mPreviousTime=Date.now(),this.mLagTime=0,this.mIsLoopRunning=!0,requestAnimationFrame((()=>{this._runLoop()}))}start(t){this.mMyGame=t,this.gEngine.ResourceMap.setLoadCompleteCallback((()=>{this.mMyGame.initialize(),this._startLoop()}))}stop(){this.mIsLoopRunning=!1}}const s={Left:37,Up:38,Right:39,Down:40,Space:32,Zero:48,One:49,Two:50,Three:51,Four:52,Five:53,Six:54,Seven:55,Eight:56,Nine:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LastKeyCode:222},n={Left:0,Middle:1,Right:2};class r{constructor(){this.mKeyPreviousState=[],this.mIsKeyPressed=[],this.mIsKeyClicked=[],this.keys=s,this.mouseButton=n,this.mCanvas=null,this.mButtonPreviousState=[],this.mIsButtonPressed=[],this.mIsButtonClicked=[],this.mMousePosX=-1,this.mMousePosY=-1}_onKeyDown(t){this.mIsKeyPressed[t.keyCode]=!0}_onKeyUp(t){this.mIsKeyPressed[t.keyCode]=!1}_onMouseMove(t){let e=!1,i=this.mCanvas.getBoundingClientRect(),s=Math.round((t.clientX-i.left)*(this.mCanvas.width/i.width)),n=Math.round((t.clientY-i.top)*(this.mCanvas.height/i.height));return s>=0&&s<this.mCanvas.width&&n>=0&&n<this.mCanvas.height&&(this.mMousePosX=s,this.mMousePosY=this.mCanvas.height-1-n,e=!0),e}_onMouseDown(t){this._onMouseMove(t)&&(this.mIsButtonPressed[t.button]=!0)}_onMouseUp(t){this._onMouseMove(t),this.mIsButtonPressed[t.button]=!1}initialize(t){let e;for(e=0;e<s.LastKeyCode;e++)this.mIsKeyPressed[e]=!1,this.mKeyPreviousState[e]=!1,this.mIsKeyClicked[e]=!1;for(window.addEventListener("keyup",(t=>this._onKeyUp(t))),window.addEventListener("keydown",(t=>this._onKeyDown(t))),e=0;e<3;e++)this.mButtonPreviousState[e]=!1,this.mIsButtonPressed[e]=!1,this.mIsButtonClicked[e]=!1;window.addEventListener("mousedown",(t=>this._onMouseDown(t))),window.addEventListener("mouseup",(t=>this._onMouseUp(t))),window.addEventListener("mousemove",(t=>this._onMouseMove(t))),this.mCanvas=document.getElementById(t)}update(){let t;for(t=0;t<s.LastKeyCode;t++)this.mIsKeyClicked[t]=!this.mKeyPreviousState[t]&&this.mIsKeyPressed[t],this.mKeyPreviousState[t]=this.mIsKeyPressed[t];for(t=0;t<3;t++)this.mIsButtonClicked[t]=!this.mButtonPreviousState[t]&&this.mIsButtonPressed[t],this.mButtonPreviousState[t]=this.mIsButtonPressed[t]}isKeyPressed(t){return this.mIsKeyPressed[t]}isKeyClicked(t){return this.mIsKeyClicked[t]}isButtonPressed(t){return this.mIsButtonPressed[t]}isButtonClicked(t){return this.mIsButtonClicked[t]}getMousePosX(){return this.mMousePosX}getMousePosY(){return this.mMousePosY}}class o{constructor(t){this.mAsset=t,this.mRefCount=1}}class h{constructor(){this.mNumOutstandingLoads=0,this.mLoadCompleteCallback=null,this.mResourceMap={}}isAssetLoaded(t){return t in this.mResourceMap}asyncLoadRequested(t){this.mResourceMap[t]=new o(t),++this.mNumOutstandingLoads}asyncLoadCompleted(t,e){console.log("ResourceMap :: asyncLoadCompleted************: "+this.mNumOutstandingLoads),this.isAssetLoaded(t)||console.log("ResourceMap:: gEngine.asyncLoadCompleted: ["+t+"] not in map!"),this.mResourceMap[t].mAsset=e,--this.mNumOutstandingLoads,this._checkForAllLoadCompleted()}_checkForAllLoadCompleted(){if(0===this.mNumOutstandingLoads&&null!==this.mLoadCompleteCallback){var t=this.mLoadCompleteCallback;this.mLoadCompleteCallback=null,t()}console.log("ResourceMap::_checkForAllLoadCompleted")}setLoadCompleteCallback(t){this.mLoadCompleteCallback=t,console.log("ResourceMap::setLoadCompleteCallback::"),this._checkForAllLoadCompleted()}retrieveAsset(t){var e=null;return t in this.mResourceMap?e=this.mResourceMap[t].mAsset:console.log("ResourceMap:: gEngine.retrieveAsset: ["+t+"] not in map!"),e}incAssetRefCount(t){this.mResourceMap[t].mRefCount+=1}unloadAsset(t){let e;return t in this.mResourceMap&&(this.mResourceMap[t].mRefCount-=1,e=this.mResourceMap[t].mRefCount,0===e&&delete this.mResourceMap[t]),console.log("ResourceMap::unloadAsset: "+e),e}}const a={eXMLFile:0,eTextFile:1};class l{constructor(t){this.gEngine=t,this.eTextFileType=a}loadTextFile(t,e,i){if(this.gEngine.ResourceMap.isAssetLoaded(t))this.gEngine.ResourceMap.incAssetRefCount(t),null!=i&&i(t);else{this.gEngine.ResourceMap.asyncLoadRequested(t);let s=new XMLHttpRequest;s.onreadystatechange=()=>{4===s.readyState&&200!==s.status&&alert(t+": loading failed! [Hint: you cannot double click index.html to run this project. The index.html file must be loaded by a web-server.]")},s.open("GET",t,!0),s.setRequestHeader("Content-Type","text/xml"),s.onload=()=>{let n=null;n=e===a.eXMLFile?(new DOMParser).parseFromString(s.responseText,"text/xml"):s.responseText,this.gEngine.ResourceMap.asyncLoadCompleted(t,n),null!=i&&i(t)},s.send()}}unloadTextFile(t){this.gEngine.ResourceMap.unloadAsset(t)}}class m{constructor(t,e,i,s){this.mName=t,this.mWidth=e,this.mHeight=i,this.mGLTexID=s,this.mColorArray=null}}class g{constructor(t){this.gEngine=t,this.gl=t.Core.getGL()}_processLoadedImage(t,e){this.gl=this.gEngine.Core.getGL();let i=this.gl.createTexture();this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null);let s=new m(t,e.naturalWidth,e.naturalHeight,i);this.gEngine.ResourceMap.asyncLoadCompleted(t,s)}loadTexture(t){if(this.gEngine.ResourceMap.isAssetLoaded(t))this.gEngine.ResourceMap.incAssetRefCount(t);else{let e=new Image;this.gEngine.ResourceMap.asyncLoadRequested(t),e.onload=()=>{this._processLoadedImage(t,e)},e.src=t}}unloadTexture(t){let e=this.gEngine.ResourceMap.retrieveAsset(t);this.gl.deleteTexture(e.mGLTexID),this.gEngine.ResourceMap.unloadAsset(t)}activateTexture(t){this.gl=this.gEngine.Core.getGL();let e=this.gEngine.ResourceMap.retrieveAsset(t);this.gl&&(this.gl.bindTexture(this.gl.TEXTURE_2D,e.mGLTexID),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR))}deactivateTexture(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)}getTextureInfo(t){return this.gEngine.ResourceMap.retrieveAsset(t)}getColorArray(t){let e=this.getTextureInfo(t);if(null===e.mColorArray){let t=this.gEngine.Core.getGL(),i=t.createFramebuffer();if(t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.mGLTexID,0),t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE){let i=new Uint8Array(e.mWidth*e.mHeight*4);t.readPixels(0,0,e.mWidth,e.mHeight,t.RGBA,t.UNSIGNED_BYTE,i),e.mColorArray=i}else alert("WARNING: Engine.Textures.getColorArray() failed!");t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteFramebuffer(i)}return e.mColorArray}}class u{constructor(t){this.gEngine=t,this.mAudioContext=null,this.mBgAudioNode=null}initAudioContext(){try{let t=window.AudioContext||window.webkitAudioContext;this.mAudioContext=new t}catch(t){alert("Web Audio Is not supported.")}}loadAudio(t){if(this.gEngine.ResourceMap.isAssetLoaded(t))this.gEngine.ResourceMap.incAssetRefCount(t);else{this.gEngine.ResourceMap.asyncLoadRequested(t);var e=new XMLHttpRequest;e.onreadystatechange=()=>{4===e.readyState&&200!==e.status&&alert(t+": loading failed! [Hint: you cannot double click index.html to run this project. The index.html file must be loaded by a web-server.]")},e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=()=>{this.mAudioContext.decodeAudioData(e.response,(e=>{this.gEngine.ResourceMap.asyncLoadCompleted(t,e)}))},e.send()}}unloadAudio(t){this.gEngine.ResourceMap.unloadAsset(t)}playACue(t){let e=this.gEngine.ResourceMap.retrieveAsset(t);if(null!==e){var i=this.mAudioContext.createBufferSource();i.buffer=e,i.connect(this.mAudioContext.destination),i.start(0)}}playBackgroundAudio(t){var e=this.gEngine.ResourceMap.retrieveAsset(t);console.log("clipInfo"),null!==e&&"string"!=typeof e&&(this.stopBackgroundAudio(),this.mBgAudioNode=this.mAudioContext.createBufferSource(),this.mBgAudioNode.buffer=e,this.mBgAudioNode.connect(this.mAudioContext.destination),this.mBgAudioNode.loop=!0,this.mBgAudioNode.start(0))}stopBackgroundAudio(){null!==this.mBgAudioNode&&(this.mBgAudioNode.stop(0),this.mBgAudioNode=null)}isBackgroundAudioPlaying(){return null!==this.mBgAudioNode}}class d{constructor(t,e,i){if(this.gEngine=t,this.gl=t.Core.getGL(),this.mCompiledShader=null,this.mShaderVertexPositionAttribute=null,this.mPixelColor=null,this.mModelTransform=null,this.mViewProjTransform=null,this.mGlobalAmbientColor=null,this.mGlobalAmbientIntensity=null,this.vertexShader=this._compileShader(e,this.gl.VERTEX_SHADER),this.fragmentShader=this._compileShader(i,this.gl.FRAGMENT_SHADER),this.mCompiledShader=this.gl.createProgram(),this.gl.attachShader(this.mCompiledShader,this.vertexShader),this.gl.attachShader(this.mCompiledShader,this.fragmentShader),this.gl.linkProgram(this.mCompiledShader),!this.gl.getProgramParameter(this.mCompiledShader,this.gl.LINK_STATUS))return alert("Error linking shader"),null;this.mShaderVertexPositionAttribute=this.gl.getAttribLocation(this.mCompiledShader,"aSquareVertexPosition"),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.VertexBuffer.getGLVertexRef()),this.gl.vertexAttribPointer(this.mShaderVertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),this.mPixelColor=this.gl.getUniformLocation(this.mCompiledShader,"uPixelColor"),this.mModelTransform=this.gl.getUniformLocation(this.mCompiledShader,"uModelTransform"),this.mViewProjTransform=this.gl.getUniformLocation(this.mCompiledShader,"uViewProjTransform"),this.mGlobalAmbientColor=this.gl.getUniformLocation(this.mCompiledShader,"uGlobalAmbientColor"),this.mGlobalAmbientIntensity=this.gl.getUniformLocation(this.mCompiledShader,"uGlobalAmbientIntensity")}getShader(){return this.mCompiledShader}activateShader(t,e){this.gl.useProgram(this.mCompiledShader),this.gl.uniformMatrix4fv(this.mViewProjTransform,!1,e.getVPMatrix()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.gEngine.VertexBuffer.getGLVertexRef()),this.gl.vertexAttribPointer(this.mShaderVertexPositionAttribute,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.mShaderVertexPositionAttribute),this.gl.uniform4fv(this.mPixelColor,t),this.gl.uniform4fv(this.mGlobalAmbientColor,this.gEngine.DefaultResources.getGlobalAmbientColor()),this.gl.uniform1f(this.mGlobalAmbientIntensity,this.gEngine.DefaultResources.getGlobalAmbientIntensity())}loadObjectTransform(t){this.gl.uniformMatrix4fv(this.mModelTransform,!1,t)}_loadAndCompileShader(t,e){var i,s;return i=t,s=this.gl.createShader(e),this.gl.shaderSource(s,i),this.gl.compileShader(s),this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS)||alert("A shader compiling error occurred: "+this.gl.getShaderInfoLog(s)),s}_compileShader(t,e){var i,s;return this.gEngine.Core.getGL(),null===(i=this.gEngine.ResourceMap.retrieveAsset(t))?(alert("WARNING: Loading of:"+t+" Failed!"),null):(s=this.gl.createShader(e),this.gl.shaderSource(s,i),this.gl.compileShader(s),this.gl.getShaderParameter(s,this.gl.COMPILE_STATUS)||alert("A shader compiling error occurred: "+this.gl.getShaderInfoLog(s)),s)}cleanUp(){var t=this.gEngine.Core.getGL();t.detachShader(this.mCompiledShader,this.mVertexShader),t.detachShader(this.mCompiledShader,this.mFragmentShader),t.deleteShader(this.mVertexShader),t.deleteShader(this.mFragmentShader)}}class c extends d{constructor(t,e,i){super(t,e,i),this.mShaderTextureCoordAttribute=null,this.gl=this.gEngine.Core.getGL(),console.log("TextureShader::constructor "),this.mShaderTextureCoordAttribute=this.gl.getAttribLocation(this.mCompiledShader,"aTextureCoordinate")}activateShader(t,e){super.activateShader(t,e),this.gl=this.gEngine.Core.getGL(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.gEngine.VertexBuffer.getGLTexCoordRef()),this.gl.enableVertexAttribArray(this.mShaderTextureCoordAttribute),this.gl.vertexAttribPointer(this.mShaderTextureCoordAttribute,2,this.gl.FLOAT,!1,0,0)}}class C extends c{constructor(t,e,i){super(t,e,i),this.mTexCoordBuffer=null,this.gEngine=t,this.initTexCoord=[1,1,0,1,1,0,0,0],this.gl=this.gEngine.Core.getGL(),this.mTexCoordBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.mTexCoordBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(this.initTexCoord),this.gl.DYNAMIC_DRAW)}activateShader(t,e){d.prototype.activateShader.call(this,t,e),this.gl=this.gEngine.Core.getGL(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.mTexCoordBuffer),this.gl.vertexAttribPointer(this.mShaderTextureCoordAttribute,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.mShaderTextureCoordAttribute)}setTextureCoordinate(t){this.gl=this.gEngine.Core.getGL(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.mTexCoordBuffer),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,new Float32Array(t))}cleanUp(){this.gEngine.Core.getGL().deleteBuffer(this.mTexCoordBuffer),d.prototype.cleanUp.call(this)}}class p extends d{constructor(t,e,i){super(t,e,i),this.mPointSizeRef=null,this.gl=t.Core.getGL(),this.gEngine=t,this.mPointSizeRef=this.gl.getUniformLocation(this.mCompiledShader,"uPointSize"),this.mPointSize=1}activateShader(t,e){super.activateShader(t,e);var i=this.gl;i.uniform1f(this.mPointSizeRef,this.mPointSize),i.bindBuffer(i.ARRAY_BUFFER,gEngine.VertexBuffer.getGLLineVertexRef()),i.vertexAttribPointer(this.mShaderVertexPositionAttribute,3,i.FLOAT,!1,0,0),i.enableVertexAttribArray(this.mShaderVertexPositionAttribute)}setPointSize(t){this.mPointSize=t}}const f=1e-6;let S="undefined"!=typeof Float32Array?Float32Array:Array;function T(){let t=new S(16);return S!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function x(){let t=new S(3);return S!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function L(t,e,i){let s=new S(3);return s[0]=t,s[1]=e,s[2]=i,s}function R(t,e,i,s){let n=new S(4);return n[0]=t,n[1]=e,n[2]=i,n[3]=s,n}function A(){let t=new S(4);return S!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}x(),function(){let t=new S(4);S!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();function E(t){let e=new S(2);return e[0]=t[0],e[1]=t[1],e}function y(t,e){let i=new S(2);return i[0]=t,i[1]=e,i}function P(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function b(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function w(t){var e=t[0],i=t[1];return Math.hypot(e,i)}function F(t,e){return t[0]*e[0]+t[1]*e[1]}function I(t,e,i){let s=[];return s[0]=e[0]*Math.cos(i)-e[1]*Math.sin(i),s[1]=e[0]*Math.sin(i)+e[1]*Math.cos(i),t[0]=s[0],t[1]=s[1],s}x(),L(1,0,0),L(0,1,0),A(),A(),function(){let t=new S(9);S!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}();const B=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t};!function(){let t=new S(2);S!=Float32Array&&(t[0]=0,t[1]=0)}();var M=Object.defineProperty;class k{constructor(t,e,i){((t,e,i)=>{((t,e,i)=>{e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i)})(this,"switchOffLight",(function(){this.gEngine.Core.getGL().uniform1i(this.mIsOnRef,!1)})),this.gEngine=t,this._setShaderReferences(e,i)}loadToShader(t,e){let i=this.gEngine.Core.getGL();if(i.uniform1i(this.mIsOnRef,e.isLightOn()),e.isLightOn()){var s=t.wcPosToPixel(e.getPosition()),n=t.wcSizeToPixel(e.getNear()),r=t.wcSizeToPixel(e.getFar()),o=e.getColor();i.uniform4fv(this.mColorRef,o),i.uniform3fv(this.mPosRef,L(s[0],s[1],s[2])),i.uniform1f(this.mNearRef,n),i.uniform1f(this.mFarRef,r),i.uniform1f(this.mIntensityRef,e.getIntensity())}}_setShaderReferences(t,e){let i=this.gEngine.Core.getGL();this.mColorRef=i.getUniformLocation(t,"uLights["+e+"].Color"),this.mPosRef=i.getUniformLocation(t,"uLights["+e+"].Position"),this.mNearRef=i.getUniformLocation(t,"uLights["+e+"].Near"),this.mFarRef=i.getUniformLocation(t,"uLights["+e+"].Far"),this.mIntensityRef=i.getUniformLocation(t,"uLights["+e+"].Intensity"),this.mIsOnRef=i.getUniformLocation(t,"uLights["+e+"].IsOn")}}class v extends C{constructor(t,e,i){let s,n;for(super(t,e,i),this.mLights=null,this.kGLSLuLightArraySize=4,this.mShaderLights=[],s=0;s<this.kGLSLuLightArraySize;s++)n=new k(t,this.mCompiledShader,s),this.mShaderLights.push(n)}activateShader(t,e){super.activateShader(t,e);let i=0;if(null!==this.mLights)for(;i<this.mLights.length;)this.mShaderLights[i].loadToShader(e,this.mLights[i]),i++;for(;i<this.kGLSLuLightArraySize;)this.mShaderLights[i].switchOffLight(),i++}setLights(t){this.mLights=t}}class W{constructor(t){this.gEngine=t,this.mGlobalAmbientColor=[.8,.8,.8,1],this.mGlobalAmbientIntensity=1,this.kSimpleVS="src/GLSLShaders/SimpleVS.glsl",this.kSimpleFS="src/GLSLShaders/SimpleFS.glsl",this.mConstColorShader=null,this.kTextureVS="src/GLSLShaders/TextureVS.glsl",this.kTextureFS="src/GLSLShaders/TextureFS.glsl",this.mTextureShader=null,this.mSpriteShader=null,this.kLineFS="src/GLSLShaders/LineFS.glsl",this.mLineShader=null,this.kLightFS="src/GLSLShaders/LightFS.glsl",this.mLightShader=null,this.kDefaultFont="assets/fonts/system-default-font"}getGlobalAmbientIntensity(){return this.mGlobalAmbientIntensity}setGlobalAmbientIntensity(t){this.mGlobalAmbientIntensity=t}getGlobalAmbientColor(){return this.mGlobalAmbientColor}setGlobalAmbientColor(t){this.mGlobalAmbientColor=R(t[0],t[1],t[2],t[3])}getDefaultFont(){return this.kDefaultFont}getConstColorShader(){return this.mConstColorShader}getTextureShader(){return this.mTextureShader}getSpriteShader(){return this.mSpriteShader}getLineShader(){return this.mLineShader}getLightShader(){return this.mLightShader}_createShaders(t){this.gEngine.ResourceMap.setLoadCompleteCallback(null),this.mConstColorShader=new d(this.gEngine,this.kSimpleVS,this.kSimpleFS),this.mTextureShader=new c(this.gEngine,this.kTextureVS,this.kTextureFS),this.mSpriteShader=new C(this.gEngine,this.kTextureVS,this.kTextureFS),this.mLineShader=new p(this.gEngine,this.kSimpleVS,this.kLineFS),this.mLightShader=new v(this.gEngine,this.kTextureVS,this.kLightFS),console.log("DefaultResources::createShader mConstColorShader"),t()}initialize(t){this.gEngine.TextFileLoader.loadTextFile(this.kSimpleVS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),this.gEngine.TextFileLoader.loadTextFile(this.kSimpleFS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),this.gEngine.TextFileLoader.loadTextFile(this.kTextureVS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),this.gEngine.TextFileLoader.loadTextFile(this.kTextureFS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),console.log("DefaultResources::initialize::loadTextFileofNums: "+this.gEngine.ResourceMap.mNumOutstandingLoads),this.gEngine.TextFileLoader.loadTextFile(this.kLineFS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),this.gEngine.TextFileLoader.loadTextFile(this.kLightFS,this.gEngine.TextFileLoader.eTextFileType.eTextFile),this.gEngine.Fonts.loadFont(this.kDefaultFont),this.gEngine.ResourceMap.setLoadCompleteCallback((()=>{this._createShaders(t)}))}cleanUp(){this.mConstColorShader.cleanUp(),this.mTextureShader.cleanUp(),this.mSpriteShader.cleanUp(),this.gEngine.TextFileLoader.unloadTextFile(this.kSimpleVS),this.gEngine.TextFileLoader.unloadTextFile(this.kSimpleFS),this.gEngine.TextFileLoader.unloadTextFile(this.kTextureVS),this.gEngine.TextFileLoader.unloadTextFile(this.kTextureFS),this.gEngine.TextFileLoader.unloadTextFile(this.kLineFS),this.gEngine.TextFileLoader.unloadTextFile(this.kLightFS),this.gEngine.Fonts.unloadFont(this.kDefaultFont)}}class _{constructor(){this.mTexCoordLeft=0,this.mTexCoordRight=1,this.mTexCoordBottom=0,this.mTexCoordTop=0,this.mCharWidth=1,this.mCharHeight=1,this.mCharWidthOffset=0,this.mCharHeightOffset=0,this.mXAdvance=0,this.mCharAspectRatio=1}}class V{constructor(t){this.gEngine=t}_storeLoadedFont(t){var e=t.slice(0,-4),i=this.gEngine.ResourceMap.retrieveAsset(t);i.FontImage=e+".png",this.gEngine.ResourceMap.asyncLoadCompleted(e,i)}loadFont(t){if(this.gEngine.ResourceMap.isAssetLoaded(t))this.gEngine.ResourceMap.incAssetRefCount(t);else{var e=t+".fnt",i=t+".png";this.gEngine.ResourceMap.asyncLoadRequested(t),console.log("Fonts::loadFont: "),this.gEngine.Textures.loadTexture(i),this.gEngine.TextFileLoader.loadTextFile(e,this.gEngine.TextFileLoader.eTextFileType.eXMLFile,(t=>this._storeLoadedFont(t)))}}unloadFont(t){if(this.gEngine.ResourceMap.unloadAsset(t),!this.gEngine.ResourceMap.isAssetLoaded(t)){var e=t+".fnt",i=t+".png";this.gEngine.Textures.unloadTexture(i),this.gEngine.TextFileLoader.unloadTextFile(e)}}getCharInfo(t,e){var i=null,s=this.gEngine.ResourceMap.retrieveAsset(t),n=s.evaluate("font/common",s,null,XPathResult.ANY_TYPE,null);if(null===(n=n.iterateNext()))return i;var r=n.getAttribute("base"),o="font/chars/char[@id="+e+"]",h=s.evaluate(o,s,null,XPathResult.ANY_TYPE,null);if(null===(h=h.iterateNext()))return i;i=new _;var a=this.gEngine.Textures.getTextureInfo(s.FontImage),l=Number(h.getAttribute("x")),m=l+Number(h.getAttribute("width"))-1,g=a.mHeight-1-Number(h.getAttribute("y")),u=g-Number(h.getAttribute("height"))+1;i.mTexCoordLeft=l/(a.mWidth-1),i.mTexCoordTop=g/(a.mHeight-1),i.mTexCoordRight=m/(a.mWidth-1),i.mTexCoordBottom=u/(a.mHeight-1);var d=h.getAttribute("xadvance");return i.mXAdvance=d,i.mCharWidth=h.getAttribute("width")/d,i.mCharHeight=h.getAttribute("height")/r,i.mCharWidthOffset=h.getAttribute("xoffset")/d,i.mCharHeightOffset=h.getAttribute("yoffset")/r,i.mCharAspectRatio=d/r,i}}class X{constructor(){if(new.target===X)throw new Error("Scene::You cant create Scene instances")}loadScene(){throw new Error("Scene::You have to implement the method loadScene!")}initialize(){throw new Error("Scene::You have to implement the method initialize!")}update(){throw new Error("Scene::You have to implement the method update!")}draw(){throw new Error("Scene::You have to implement the method draw!")}unloadScene(){throw new Error("Scene::You have to implement the method unloadScene!")}}var G=Object.defineProperty;const D=class{constructor(t,e,i){this.mLL=y(0,0),this.setBounds(t,e,i)}setBounds(t,e,i){this.mWidth=e,this.mHeight=i,this.mLL[0]=t[0]-e/2,this.mLL[1]=t[1]-i/2}containsPoint(t,e){return t>this.minX()&&t<this.maxX()&&e>this.minY()&&e<this.maxY()}intersectsBound(t){return this.minX()<t.maxX()&&this.maxX()>t.minX()&&this.minY()<t.maxY()&&this.maxY()>t.minY()}boundCollideStatus(t){let e=D.eboundCollideStatus.eOutside;return this.intersectsBound(t)&&(t.minX()<this.minX()&&(e|=D.eboundCollideStatus.eCollideLeft),t.maxX()>this.maxX()&&(e|=D.eboundCollideStatus.eCollideRight),t.minY()<this.minY()&&(e|=D.eboundCollideStatus.eCollideBottom),t.maxY()>this.maxY()&&(e|=D.eboundCollideStatus.eCollideTop),e===D.eboundCollideStatus.eOutside&&(e=D.eboundCollideStatus.eInside)),e}minX(){return this.mLL[0]}maxX(){return this.mLL[0]+this.mWidth}minY(){return this.mLL[1]}maxY(){return this.mLL[1]+this.mHeight}};let O=D;var H;((t,e,i)=>{e in t?G(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(O,"symbol"!=typeof(H="eboundCollideStatus")?H+"":H,{eCollideLeft:1,eCollideRight:2,eCollideTop:4,eCollideBottom:8,eInside:16,eOutside:0});class U{constructor(t,e,i,s){this.mXMag=t,this.mYMag=e,this.mCycles=s,this.mOmega=2*i*Math.PI,this.mNumCyclesLeft=s}shakeDone(){return this.mNumCyclesLeft<=0}getShakeResults(){this.mNumCyclesLeft--;let t=[],e=0,i=0;if(!this.shakeDone()){let t=this._nextDampedHarmonic();e=Math.random()>.5?-t:t,i=Math.random()>.5?-t:t}return t[0]=this.mXMag*e,t[1]=this.mYMag*i,t}_nextDampedHarmonic(){let t=this.mNumCyclesLeft/this.mCycles;return t*t*Math.cos((1-t)*this.mOmega)}}class N{constructor(t,e,i,s,n){this.mOrgCenter=E(t.getCenter()),this.mShakeCenter=E(this.mOrgCenter),this.mShake=new U(e,i,s,n)}updateShakeState(){let t=this.mShake.getShakeResults();P(this.mShakeCenter,this.mOrgCenter,t)}shakeDone(){return this.mShake.shakeDone()}getCenter(){return this.mShakeCenter}setRefCenter(t){this.mOrgCenter[0]=t[0],this.mOrgCenter[1]=t[1]}}const Y={panWith:function(t,e){let i=this.collideWCBound(t,e);if(i!==O.eboundCollideStatus.eInside){var s=t.getPosition(),n=this.getWCCenter();0!=(i&O.eboundCollideStatus.eCollideTop)&&(n[1]=s[1]+t.getHeight()/2-e*this.getWCHeight()/2),0!=(i&O.eboundCollideStatus.eCollideBottom)&&(n[1]=s[1]-t.getHeight()/2+e*this.getWCHeight()/2),0!=(i&O.eboundCollideStatus.eCollideRight)&&(n[0]=s[0]+t.getWidth()/2-e*this.getWCWidth()/2),0!=(i&O.eboundCollideStatus.eCollideLeft)&&(n[0]=s[0]-t.getWidth()/2+e*this.getWCWidth()/2),this.mCameraState.setCenter(n)}},panTo:function(t,e){this.setWCCenter(t,e)},zoomBy:function(t){t>0&&this.setWCWidth(this.getWCWidth()*t)},zoomTowards:function(t,e){var i=[],s=[];B(i,t,this.getWCCenter()),b(i,i,e-1),B(s,this.getWCCenter(),i),this.zoomBy(e),this.mCameraState.setCenter(s)},update:function(){null!==this.mCameraShake&&(this.mCameraShake.shakeDone()?this.mCameraShake=null:(this.mCameraShake.setRefCenter(this.getWCCenter()),this.mCameraShake.updateShakeState())),this.mCameraState.updateCameraState()},panBy:function(t,e){let i=E(this.getWCCenter());i[0]+=t,i[1]+=e,this.mCameraState.setCenter(i)},configInterpolation:function(t,e){this.mCameraState.configInterpolation(t,e)},shake:function(t,e,i,s){this.mCameraShake=new N(this.mCameraState,t,e,i,s)}};class K{constructor(t,e,i){this.mCurrentValue=t,this.mFinalValue=t,this.mCycles=e,this.mRate=i,this.mCyclesLeft=0}getValue(){return this.mCurrentValue}setFinalValue(t){this.mFinalValue=t,this.mCyclesLeft=this.mCycles}updateInterpolation(){this.mCyclesLeft<=0||(this.mCyclesLeft--,0===this.mCyclesLeft?this.mCurrentValue=this.mFinalValue:this._interpolateValue())}configInterpolation(t,e){this.mRate=t,this.mCycles=e}_interpolateValue(){this.mCurrentValue=this.mCurrentValue+this.mRate*(this.mFinalValue-this.mCurrentValue)}}class z extends K{constructor(t,e,i){super(t,e,i)}_interpolateValue(){var t,e,i,s,n,r;t=this.mCurrentValue,e=this.mCurrentValue,i=this.mFinalValue,s=this.mRate,n=e[0],r=e[1],t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r)}}class j{constructor(t,e){this.kCycles=300,this.kRate=.1,this.mCenter=new z(t,this.kCycles,this.kRate),this.mWidth=new K(e,this.kCycles,this.kRate)}getCenter(){return this.mCenter.getValue()}getWidth(){return this.mWidth.getValue()}setCenter(t){this.mCenter.setFinalValue(t)}setWidth(t){this.mWidth.setFinalValue(t)}updateCameraState(){this.mCenter.updateInterpolation(),this.mWidth.updateInterpolation()}configInterpolation(t,e){this.mCenter.configInterpolation(t,e),this.mWidth.configInterpolation(t,e)}}const q={_mouseDCX:function(){return this.gEngine.Input.getMousePosX()-this.mViewport[rt.eViewport.eOrgX]},_mouseDCY:function(){return this.gEngine.Input.getMousePosY()-this.mViewport[rt.eViewport.eOrgY]},isMouseInViewport:function(){let t=this._mouseDCX.call(this),e=this._mouseDCY.call(this);return t>=0&&t<this.mViewport[rt.eViewport.eWidth]&&e>=0&&e<this.mViewport[rt.eViewport.eHeight]},mouseWCX:function(){return this.getWCCenter()[0]-this.getWCWidth()/2+this._mouseDCX()*(this.getWCWidth()/this.mViewport[rt.eViewport.eWidth])},mouseWCY:function(){return this.getWCCenter()[1]-this.getWCHeight()/2+this._mouseDCY()*(this.getWCHeight()/this.mViewport[rt.eViewport.eHeight])}},Z={fakeZInPixelSpace:function(t){return t*this.mRenderCache.mWCToPixelRatio},wcPosToPixel:function(t){return L(this.mViewport[rt.eViewport.eOrgX]+(t[0]-this.mRenderCache.mCameraOrgX)*this.mRenderCache.mWCToPixelRatio+.5,this.mViewport[rt.eViewport.eOrgY]+(t[1]-this.mRenderCache.mCameraOrgY)*this.mRenderCache.mWCToPixelRatio+.5,this.fakeZInPixelSpace(t[2]))},wcSizeToPixel:function(t){return t*this.mRenderCache.mWCToPixelRatio+.5}};var J=Object.defineProperty,Q=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,tt=Object.prototype.propertyIsEnumerable,et=(t,e,i)=>e in t?J(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,it=(t,e)=>{for(var i in e||(e={}))$.call(e,i)&&et(t,i,e[i]);if(Q)for(var i of Q(e))tt.call(e,i)&&et(t,i,e[i]);return t};class st{constructor(){this.mWCToPixelRatio=1,this.mCameraOrgX=1,this.mCameraOrgY=1}}const nt=class{constructor(t,e,i,s,n){this.gl=t.Core.getGL(),this.gEngine=t,this.mCameraState=new j(e,i),this.mCameraShake=null,this.mViewport=[],this.mViewportBound=0,void 0!==n&&(this.mViewportBound=n),this.mScissorBound=[],this.setViewport(s,this.mViewportBound),this.mNearPlane=0,this.mFarPlane=1e3,this.mViewMatrix=T(),this.mProjMatrix=T(),this.mVPMatrix=T(),this.mBgColor=[.8,.8,.8,1],this.mRenderCache=new st,Object.assign(this,it(it(it({},Y),q),Z))}setWCCenter(t,e){let i=y(t,e);this.mCameraState.setCenter(i)}getWCCenter(){return this.mCameraState.getCenter()}setWCWidth(t){this.mCameraState.setWidth(t)}getWCWidth(){return this.mCameraState.getWidth()}getWCHeight(){return this.mCameraState.getWidth()*this.mViewport[nt.eViewport.eHeight]/this.mViewport[nt.eViewport.eWidth]}setViewport(t,e){void 0===e&&(e=this.mViewportBound),this.mViewport[0]=t[0]+e,this.mViewport[1]=t[1]+e,this.mViewport[2]=t[2]-2*e,this.mViewport[3]=t[3]-2*e,this.mScissorBound[0]=t[0],this.mScissorBound[1]=t[1],this.mScissorBound[2]=t[2],this.mScissorBound[3]=t[3]}getViewport(){let t=[];return t[0]=this.mScissorBound[0],t[1]=this.mScissorBound[1],t[2]=this.mScissorBound[2],t[3]=this.mScissorBound[3],t}setBackgroundColor(t){this.mBgColor=t}getBackgroundColor(){return this.mBgColor}getVPMatrix(){return this.mVPMatrix}setupViewProjection(){this.gl.viewport(this.mViewport[0],this.mViewport[1],this.mViewport[2],this.mViewport[3]),this.gl.scissor(this.mScissorBound[0],this.mScissorBound[1],this.mScissorBound[2],this.mScissorBound[3]),this.gl.clearColor(this.mBgColor[0],this.mBgColor[1],this.mBgColor[2],this.mBgColor[3]),this.gl.enable(this.gl.SCISSOR_TEST),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.disable(this.gl.SCISSOR_TEST);let t=[];t=null!==this.mCameraShake?this.mCameraShake.getCenter():this.getWCCenter(),function(t,e,i,s){let n,r,o,h,a,l,m,g,u,d,c=e[0],C=e[1],p=e[2],S=s[0],T=s[1],x=s[2],L=i[0],R=i[1],A=i[2];Math.abs(c-L)<f&&Math.abs(C-R)<f&&Math.abs(p-A)<f?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(m=c-L,g=C-R,u=p-A,d=1/Math.hypot(m,g,u),m*=d,g*=d,u*=d,n=T*u-x*g,r=x*m-S*u,o=S*g-T*m,d=Math.hypot(n,r,o),d?(d=1/d,n*=d,r*=d,o*=d):(n=0,r=0,o=0),h=g*o-u*r,a=u*n-m*o,l=m*r-g*n,d=Math.hypot(h,a,l),d?(d=1/d,h*=d,a*=d,l*=d):(h=0,a=0,l=0),t[0]=n,t[1]=h,t[2]=m,t[3]=0,t[4]=r,t[5]=a,t[6]=g,t[7]=0,t[8]=o,t[9]=l,t[10]=u,t[11]=0,t[12]=-(n*c+r*C+o*p),t[13]=-(h*c+a*C+l*p),t[14]=-(m*c+g*C+u*p),t[15]=1)}(this.mViewMatrix,[t[0],t[1],10],[t[0],t[1],0],[0,1,0]);let e=.5*this.getWCWidth(),i=e*this.mViewport[3]/this.mViewport[2];(function(t,e,i,s,n,r,o){const h=1/(e-i),a=1/(s-n),l=1/(r-o);t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*h,t[13]=(n+s)*a,t[14]=(o+r)*l,t[15]=1})(this.mProjMatrix,-e,e,-i,i,this.mNearPlane,this.mFarPlane),function(t,e,i){let s=e[0],n=e[1],r=e[2],o=e[3],h=e[4],a=e[5],l=e[6],m=e[7],g=e[8],u=e[9],d=e[10],c=e[11],C=e[12],p=e[13],f=e[14],S=e[15],T=i[0],x=i[1],L=i[2],R=i[3];t[0]=T*s+x*h+L*g+R*C,t[1]=T*n+x*a+L*u+R*p,t[2]=T*r+x*l+L*d+R*f,t[3]=T*o+x*m+L*c+R*S,T=i[4],x=i[5],L=i[6],R=i[7],t[4]=T*s+x*h+L*g+R*C,t[5]=T*n+x*a+L*u+R*p,t[6]=T*r+x*l+L*d+R*f,t[7]=T*o+x*m+L*c+R*S,T=i[8],x=i[9],L=i[10],R=i[11],t[8]=T*s+x*h+L*g+R*C,t[9]=T*n+x*a+L*u+R*p,t[10]=T*r+x*l+L*d+R*f,t[11]=T*o+x*m+L*c+R*S,T=i[12],x=i[13],L=i[14],R=i[15],t[12]=T*s+x*h+L*g+R*C,t[13]=T*n+x*a+L*u+R*p,t[14]=T*r+x*l+L*d+R*f,t[15]=T*o+x*m+L*c+R*S}(this.mVPMatrix,this.mProjMatrix,this.mViewMatrix),this.mRenderCache.mWCToPixelRatio=this.mViewport[nt.eViewport.eWidth]/this.getWCWidth(),this.mRenderCache.mCameraOrgX=t[0]-this.getWCWidth()/2,this.mRenderCache.mCameraOrgY=t[1]-this.getWCHeight()/2}collideWCBound(t,e){let i=new O(t.getPosition(),t.getWidth(),t.getHeight()),s=e*this.getWCWidth(),n=e*this.getWCHeight();return new O(this.getWCCenter(),s,n).boundCollideStatus(i)}clampAtBoundary(t,e){var i=this.collideWCBound(t,e);if(i!==O.eboundCollideStatus.eInside){var s=t.getPosition();0!=(i&O.eboundCollideStatus.eCollideTop)&&(s[1]=this.getWCCenter()[1]+e*this.getWCHeight()/2-t.getHeight()/2),0!=(i&O.eboundCollideStatus.eCollideBottom)&&(s[1]=this.getWCCenter()[1]-e*this.getWCHeight()/2+t.getHeight()/2),0!=(i&O.eboundCollideStatus.eCollideRight)&&(s[0]=this.getWCCenter()[0]+e*this.getWCWidth()/2-t.getWidth()/2),0!=(i&O.eboundCollideStatus.eCollideLeft)&&(s[0]=this.getWCCenter()[0]-e*this.getWCWidth()/2+t.getWidth()/2)}return i}};let rt=nt;((t,e,i)=>{et(t,e+"",{eOrgX:0,eOrgY:1,eWidth:2,eHeight:3})})(rt,"eViewport");class ot{constructor(){this.mPosition=y(0,0),this.mScale=y(1,1),this.mRotationInRad=0}getXPos(){return this.mPosition[0]}setXPos(t){this.mPosition[0]=t}getYPos(){return this.mPosition[1]}setYPos(t){this.mPosition[1]=t}setPosition(t,e){this.setXPos(t),this.setYPos(e)}getPosition(){return this.mPosition}incXPosBy(t){this.mPosition[0]+=t}incYPosBy(t){this.mPosition[1]+=t}getWidth(){return this.mScale[0]}setWidth(t){this.mScale[0]=t}incWidthBy(t){this.mScale[0]+=t}getHeight(){return this.mScale[1]}setHeight(t){this.mScale[1]=t}incHeightBy(t){this.mScale[1]+=t}setSize(t,e){this.setWidth(t),this.setHeight(e)}getSize(){return this.mScale}incSizeBy(t){this.incWidthBy(t),this.incHeightBy(t)}setRotationInRad(t){for(this.mRotationInRad=t;this.mRotationInRad>2*Math.PI;)this.mRotationInRad-=2*Math.PI}setRotationInDegree(t){this.setRotationInRad(t*Math.PI/180)}incRotationByDegree(t){this.incRotationByRad(t*Math.PI/180)}incRotationByRad(t){this.setRotationInRad(this.mRotationInRad+t)}getRotationInRad(){return this.mRotationInRad}getRotationInDegree(){return 180*this.mRotationInRad/Math.PI}getXform(){var t=T();return function(t,e,i){let s,n,r,o,h,a,l,m,g,u,d,c,C=i[0],p=i[1],f=i[2];e===t?(t[12]=e[0]*C+e[4]*p+e[8]*f+e[12],t[13]=e[1]*C+e[5]*p+e[9]*f+e[13],t[14]=e[2]*C+e[6]*p+e[10]*f+e[14],t[15]=e[3]*C+e[7]*p+e[11]*f+e[15]):(s=e[0],n=e[1],r=e[2],o=e[3],h=e[4],a=e[5],l=e[6],m=e[7],g=e[8],u=e[9],d=e[10],c=e[11],t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=h,t[5]=a,t[6]=l,t[7]=m,t[8]=g,t[9]=u,t[10]=d,t[11]=c,t[12]=s*C+h*p+g*f+e[12],t[13]=n*C+a*p+u*f+e[13],t[14]=r*C+l*p+d*f+e[14],t[15]=o*C+m*p+c*f+e[15])}(t,t,L(this.getXPos(),this.getYPos(),0)),function(t,e,i){let s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],h=e[2],a=e[3],l=e[4],m=e[5],g=e[6],u=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n+l*s,t[1]=o*n+m*s,t[2]=h*n+g*s,t[3]=a*n+u*s,t[4]=l*n-r*s,t[5]=m*n-o*s,t[6]=g*n-h*s,t[7]=u*n-a*s}(t,t,this.getRotationInRad()),function(t,e,i){let s=i[0],n=i[1],r=i[2];t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(t,t,L(this.getWidth(),this.getHeight(),1)),t}}class ht{constructor(t){this.gEnigne=t,console.log("Renderable::constructor:-- "+this.gEnigne.DefaultResources.getConstColorShader()),this.mShader=this.gEnigne.DefaultResources.getConstColorShader(),console.log("Renderable::constructor: "+this.mShader),this.mColor=[1,1,1,1],this.mXform=new ot,this.gl=this.gEnigne.Core.getGL()}draw(t){this.mShader.activateShader(this.mColor,t),this.mShader.loadObjectTransform(this.mXform.getXform()),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}setColor(t){this.mColor=t}getColor(){return this.mColor}getXform(){return this.mXform}_setShader(t){this.mShader=t}}class at extends ht{constructor(t,e){super(t),this.gEngine=t,super.setColor([1,1,1,0]),super._setShader(this.gEngine.DefaultResources.getTextureShader()),this.mTexture=e,this.mTextureInfo=null,this.mColorArray=null,this.mTexWidth=0,this.mTexHeight=0,this.mTexLeftIndex=0,this.mTexBottomIndex=0,this.setTexture(e)}draw(t){this.gEngine.Textures.activateTexture(this.mTexture),super.draw(t)}getTexture(){return this.mTexture}setTexture(t){this.mTexture=t,this.mTextureInfo=this.gEngine.Textures.getTextureInfo(t),this.mColorArray=null,this.mTexWidth=this.mTextureInfo.mWidth,this.mTexHeight=this.mTextureInfo.mHeight,this.mTexLeftIndex=0,this.mTexBottomIndex=0}pixelTouches(t,e){var i,s=!1,n=0,r=[0,0],o=[1,0],h=[0,1],a=[1,0],l=[0,1];for(I(o,o,this.mXform.getRotationInRad()),I(h,h,this.mXform.getRotationInRad()),I(a,a,t.mXform.getRotationInRad()),I(l,l,t.mXform.getRotationInRad());!s&&n<this.mTexWidth;){for(i=0;!s&&i<this.mTexHeight;)this._pixelAlphaValue(n,i)>0&&(this._indexToWCPosition(e,n,i,o,h),t._wcPositionToIndex(r,e,a,l),r[0]>=0&&r[0]<t.mTexWidth&&r[1]>=0&&r[1]<t.mTexHeight&&(s=t._pixelAlphaValue(r[0],r[1])>0)),i++;n++}return s}setColorArray(){null===this.mColorArray&&(this.mColorArray=this.gEngine.Textures.getColorArray(this.mTexture))}_pixelAlphaValue(t,e){return e+=this.mTexBottomIndex,t+=this.mTexLeftIndex,t*=4,e*=4,this.mColorArray[e*this.mTextureInfo.mWidth+t+3]}_wcPositionToIndex(t,e,i,s){let n=[];B(n,e,this.mXform.getPosition());let r=F(n,i),o=F(n,s);t[0]=this.mTexWidth*(r/this.mXform.getWidth()),t[1]=this.mTexHeight*(o/this.mXform.getHeight()),t[0]+=this.mTexWidth/2,t[1]+=this.mTexHeight/2,t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1])}_indexToWCPosition(t,e,i,s,n){var r=e*this.mXform.getWidth()/this.mTexWidth,o=i*this.mXform.getHeight()/this.mTexHeight,h=r-.5*this.mXform.getWidth(),a=o-.5*this.mXform.getHeight(),l=[],m=[];b(l,s,h),b(m,n,a),P(t,this.mXform.getPosition(),l),P(t,t,m)}}var lt=Object.defineProperty;class mt extends at{constructor(t,e){super(t,e),this.gEnigne=t,ht.prototype._setShader.call(this,this.gEnigne.DefaultResources.getSpriteShader()),this.mTexLeft=0,this.mTexRight=1,this.mTexTop=1,this.mTexBottom=0,this._setTexInfo(),console.log("SpriteRenderable::constructor: ")}setElementUVCoordinate(t,e,i,s){this.mTexLeft=t,this.mTexRight=e,this.mTexBottom=i,this.mTexTop=s,this._setTexInfo()}setElementPixelPositions(t,e,i,s){var n=this.gEnigne.ResourceMap.retrieveAsset(this.mTexture),r=n.mWidth,o=n.mHeight;this.mTexLeft=t/r,this.mTexRight=e/r,this.mTexBottom=i/o,this.mTexTop=s/o,this._setTexInfo()}getElementUVCoordinateArray(){return[this.mTexRight,this.mTexTop,this.mTexLeft,this.mTexTop,this.mTexRight,this.mTexBottom,this.mTexLeft,this.mTexBottom]}draw(t){this.mShader.setTextureCoordinate(this.getElementUVCoordinateArray()),super.draw(t)}_setTexInfo(){var t=this.mTextureInfo.mWidth,e=this.mTextureInfo.mHeight;this.mTexLeftIndex=this.mTexLeft*t,this.mTexBottomIndex=this.mTexBottom*e,this.mTexWidth=(this.mTexRight-this.mTexLeft)*t+1,this.mTexHeight=(this.mTexTop-this.mTexBottom)*e+1}}((t,e,i)=>{((t,e,i)=>{e in t?lt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,e+"",{eLeft:2,eRight:0,eTop:1,eBottom:5})})(mt,"eTexCoordArray");class gt{constructor(t,e){this.gEngine=t,this.mFont=this.gEngine.DefaultResources.getDefaultFont(),this.mOneChar=new mt(this.gEngine,this.mFont+".png"),this.mXform=new ot,this.mText=e}draw(t){var e,i,s,n,r,o,h,a=this.mXform.getWidth()/this.mText.length,l=this.mXform.getHeight(),m=this.mXform.getYPos(),g=this.mXform.getXPos()-a/2+.5*a;for(e=0;e<this.mText.length;e++)i=this.mText.charCodeAt(e),s=this.gEngine.Fonts.getCharInfo(this.mFont,i),this.mOneChar.setElementUVCoordinate(s.mTexCoordLeft,s.mTexCoordRight,s.mTexCoordBottom,s.mTexCoordTop),n=a*s.mCharWidth,r=l*s.mCharHeight,this.mOneChar.getXform().setSize(n,r),o=a*s.mCharWidthOffset*.5,h=l*s.mCharHeightOffset*.5,this.mOneChar.getXform().setPosition(g-o,m-h),this.mOneChar.draw(t),g+=a}getXform(){return this.mXform}getText(){return this.mText}setText(t){this.mText=t,this.setTextHeight(this.getXform().getHeight())}setTextHeight(t){var e=t*this.gEngine.Fonts.getCharInfo(this.mFont,"A".charCodeAt(0)).mCharAspectRatio;this.getXform().setSize(e*this.mText.length,t)}getFont(){return this.mFont}setFont(t){this.mFont=t,this.mOneChar.setTexture(this.mFont+".png")}setColor(t){this.mOneChar.setColor(t)}getColor(){return this.mOneChar.getColor()}update(){}getStringWidth(t){var e,i,s,n=0,r=t;for(e=0;e<this.mText.length;e++)i=this.mText.charCodeAt(e),s=this.gEngine.Fonts.getCharInfo(this.mFont,i),console.log("FontRenderable::getStringWidth:"),n+=r*s.mCharWidth*s.mXAdvance;return n}}class ut{constructor(){this.mRenderComponent=null,this.mVisible=!0,this.mCurrentFrontDir=y(0,1),this.mSpeed=0}getXform(){return this.mRenderComponent.getXform()}getBBox(){let t=this.getXform();return new O(t.getPosition(),t.getWidth(),t.getHeight())}setVisibility(t){this.mVisible=t}isVisible(){return this.mVisible}setSpeed(t){this.mSpeed=t}getSpeed(){return this.mSpeed}incSpeedBy(t){this.mSpeed+=t}setCurrentFrontDir(t){var e,i,s,n,r;e=this.mCurrentFrontDir,(r=(s=(i=t)[0])*s+(n=i[1])*n)>0&&(r=1/Math.sqrt(r)),e[0]=i[0]*r,e[1]=i[1]*r}getCurrentFrontDir(){return this.mCurrentFrontDir}rotateObjPointTo(t,e){let i=[];B(i,t,this.getXform().getPosition());let s=w(i);if(s<Number.MIN_VALUE)return;b(i,i,1/s);let n=this.getCurrentFrontDir(),r=F(i,n);if(r>.999999)return;r>1?r=1:r<-1&&(r=-1);let o=L(i[0],i[1],0),h=[];!function(t,e,i){let s=e[0],n=e[1],r=e[2],o=i[0],h=i[1],a=i[2];t[0]=n*a-r*h,t[1]=r*o-s*a,t[2]=s*h-n*o}(h,L(n[0],n[1],0),o);let a=Math.acos(r);h[2]<0&&(a=-a),a*=e,I(this.getCurrentFrontDir(),this.getCurrentFrontDir(),a),this.getXform().incRotationByRad(a)}update(){let t=this.getXform().getPosition();var e,i,s,n;e=t,i=t,s=this.getCurrentFrontDir(),n=this.getSpeed(),e[0]=i[0]+s[0]*n,e[1]=i[1]+s[1]*n}getRenderable(){return this.mRenderComponent}setRenderable(t){this.mRenderComponent=t}draw(t){this.isVisible()&&this.mRenderComponent.draw(t)}pixelTouches(t,e){var i=!1,s=this.getRenderable(),n=t.getRenderable();if("function"==typeof s.pixelTouches&&"function"==typeof n.pixelTouches)if(0===s.getXform().getRotationInRad()&&0===n.getXform().getRotationInRad())t.getBBox().intersectsBound(this.getBBox())&&(s.setColorArray(),n.setColorArray(),i=s.pixelTouches(n,e));else{var r=s.getXform().getSize(),o=n.getXform().getSize(),h=Math.sqrt(.5*r[0]*.5*r[0]+.5*r[1]*.5*r[1]),a=Math.sqrt(.5*o[0]*.5*o[0]+.5*o[1]*.5*o[1]),l=[];B(l,s.getXform().getPosition(),n.getXform().getPosition()),w(l)<h+a&&(s.setColorArray(),n.setColorArray(),i=s.pixelTouches(n,e))}return i}}var dt=Object.defineProperty;const ct=class extends mt{constructor(t,e){super(t,e),this.gEngine=t,super._setShader.call(this,t.DefaultResources.getSpriteShader()),this.mFirstElmLeft=0,this.mElmTop=1,this.mElmWidth=1,this.mElmHeight=1,this.mWidthPadding=0,this.mNumElems=1,this.mUpdateInterval=1,this.mAnimationType=ct.eAnimationType.eAnimateRight,this.mCurrentAnimAdvance=-1,this.mCurrentElm=0,this._initAnimation()}_initAnimation(){switch(this.mCurrentTick=0,this.mAnimationType){case ct.eAnimationType.eAnimateRight:this.mCurrentElm=0,this.mCurrentAnimAdvance=1;break;case ct.eAnimationType.eAnimateSwing:this.mCurrentAnimAdvance=-1*this.mCurrentAnimAdvance,this.mCurrentElm+=2*this.mCurrentAnimAdvance;break;case ct.eAnimationType.eAnimateLeft:this.mCurrentElm=this.mNumElems-1,this.mCurrentAnimAdvance=-1}this._setSpriteElement()}_setSpriteElement(){var t=this.mFirstElmLeft+this.mCurrentElm*(this.mElmWidth+this.mWidthPadding);super.setElementUVCoordinate.call(this,t,t+this.mElmWidth,this.mElmTop-this.mElmHeight,this.mElmTop)}setSpriteSequence(t,e,i,s,n,r){var o=this.gEngine.ResourceMap.retrieveAsset(this.mTexture),h=o.mWidth,a=o.mHeight;this.mNumElems=n,this.mFirstElmLeft=e/h,this.mElmTop=t/a,this.mElmWidth=i/h,this.mElmHeight=s/a,this.mWidthPadding=r/h,this._initAnimation()}setAnimationSpeed(t){this.mUpdateInterval=t}incAnimationSpeed(t){this.mUpdateInterval+=t}setAnimationType(t){this.mAnimationType=t,this.mCurrentAnimAdvance=-1,this.mCurrentElm=0,this._initAnimation()}updateAnimation(){this.mCurrentTick++,this.mCurrentTick>=this.mUpdateInterval&&(this.mCurrentTick=0,this.mCurrentElm+=this.mCurrentAnimAdvance,this.mCurrentElm>=0&&this.mCurrentElm<this.mNumElems?this._setSpriteElement():this._initAnimation())}};let Ct=ct;((t,e,i)=>{((t,e,i)=>{e in t?dt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,e+"",{eAnimateRight:0,eAnimateLeft:1,eAnimateSwing:2})})(Ct,"eAnimationType");class pt extends Ct{constructor(t,e){super(t,e),super._setShader(t.DefaultResources.getLightShader()),this.mLights=[]}draw(t){this.mShader.setLights(this.mLights),super.draw(t)}getLightAt(t){return this.mLights[t]}addLight(t){this.mLights.push(t)}}class ft extends ut{constructor(t,e){super(),this.gEngine=t,this.kDelta=.3,this.mDye=new pt(t,e),this.mDye.setColor([1,1,1,0]),this.mDye.getXform().setPosition(35,50),this.mDye.getXform().setSize(9,12),this.mDye.setElementPixelPositions(0,120,0,180),super.setRenderable(this.mDye)}update(){var t=this.getXform();this.gEngine.Input.isKeyPressed(this.gEngine.Input.keys.W)&&t.incYPosBy(this.kDelta),this.gEngine.Input.isKeyPressed(this.gEngine.Input.keys.S)&&t.incYPosBy(-this.kDelta),this.gEngine.Input.isKeyPressed(this.gEngine.Input.keys.A)&&t.incXPosBy(-this.kDelta),this.gEngine.Input.isKeyPressed(this.gEngine.Input.keys.D)&&t.incXPosBy(this.kDelta)}}class St extends ut{constructor(t,e,i){super(),this.gEngine=t,this.kDelta=.2,this.mMinion=new pt(t,e),this.mMinion.setColor([1,1,1,0]),this.mMinion.getXform().setPosition(100*Math.random(),i),this.mMinion.getXform().setSize(12,9.6),this.mMinion.setSpriteSequence(512,0,204,164,5,0),this.mMinion.setAnimationType(Ct.eAnimationType.eAnimateSwing),this.mMinion.setAnimationSpeed(15),super.setRenderable(this.mMinion)}update(){this.mMinion.updateAnimation();var t=this.getXform();t.incXPosBy(-this.kDelta),t.getXPos()<0&&(t.setXPos(100),t.setYPos(65*Math.random()))}}class Tt{constructor(){this.mColor=R(.1,.1,.1,1),this.mPosition=L(0,0,5),this.mNear=5,this.mFar=10,this.mIntensity=1,this.mIsOn=!0}setColor(t){this.mColor=function(t){let e=new S(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}(t)}getColor(){return this.mColor}set2DPosition(t){this.mPosition=L(t[0],t[1],this.mPosition[2])}setXPos(t){this.mPosition[0]=t}setYPos(t){this.mPosition[1]=t}setZPos(t){this.mPosition[2]=t}getPosition(){return this.mPosition}setNear(t){this.mNear=t}getNear(){return this.mNear}setFar(t){this.mFar=t}getFar(){return this.mFar}setIntensity(t){this.mIntensity=t}getIntensity(){return this.mIntensity}setLightTo(t){this.mIsOn=t}isLightOn(){return this.mIsOn}}class xt{constructor(){this.mSet=[]}numLights(){return this.mSet.length}getLightAt(t){return this.mSet[t]}addToSet(t){this.mSet.push(t)}}const Lt={_createALight:function(t,e,i,s,n){let r=new Tt;return r.setColor(e),r.setXPos(t[0]),r.setYPos(t[1]),r.setZPos(t[2]),r.setNear(i),r.setFar(s),r.setIntensity(n),r},_initializeLights:function(){this.mGlobalLightSet=new xt;var t=this._createALight([21,58,5],[.2,.2,.8,1],20,50,5.5);this.mGlobalLightSet.addToSet(t),t=this._createALight([24,24,8],[.4,.7,.4,1],20,45,2.8),this.mGlobalLightSet.addToSet(t),t=this._createALight([66,23,10],[.7,.7,.7,1],10,35,3),this.mGlobalLightSet.addToSet(t),t=this._createALight([72,57,6],[.8,.6,.6,1],15,40,3),this.mGlobalLightSet.addToSet(t)}},Rt={_lightControl:function(){var t=.2;const e=this.gEngine;this._selectLight();var i=this.mGlobalLightSet.getLightAt(this.mLgtIndex),s=i.getPosition();return e.Input.isKeyPressed(e.Input.keys.Left)&&i.setXPos(s[0]-t),e.Input.isKeyPressed(e.Input.keys.Right)&&i.setXPos(s[0]+t),e.Input.isKeyPressed(e.Input.keys.Up)&&i.setYPos(s[1]+t),e.Input.isKeyPressed(e.Input.keys.Down)&&i.setYPos(s[1]-t),e.Input.isKeyPressed(e.Input.keys.Z)&&i.setZPos(s[2]+t),e.Input.isKeyPressed(e.Input.keys.X)&&i.setZPos(s[2]-t),e.Input.isKeyPressed(e.Input.keys.C)&&i.setNear(i.getNear()+t),e.Input.isKeyPressed(e.Input.keys.V)&&i.setNear(i.getNear()-t),e.Input.isKeyPressed(e.Input.keys.B)&&i.setFar(i.getFar()+t),e.Input.isKeyPressed(e.Input.keys.N)&&i.setFar(i.getFar()-t),e.Input.isKeyPressed(e.Input.keys.K)&&i.setIntensity(i.getIntensity()+t),e.Input.isKeyPressed(e.Input.keys.L)&&i.setIntensity(i.getIntensity()-t),e.Input.isKeyClicked(e.Input.keys.H)&&i.setLightTo(!i.isLightOn()),"On("+i.isLightOn()+") "+this._printVec3("P",s)+"R("+i.getNear().toPrecision(3)+"/"+i.getFar().toPrecision(3)+") I("+i.getIntensity().toPrecision(3)+")"},_selectLight:function(){const t=this.gEngine;t.Input.isKeyClicked(t.Input.keys.Zero)&&(this.mLgtIndex=0),t.Input.isKeyClicked(t.Input.keys.One)&&(this.mLgtIndex=1),t.Input.isKeyClicked(t.Input.keys.Two)&&(this.mLgtIndex=2),t.Input.isKeyClicked(t.Input.keys.Three)&&(this.mLgtIndex=3)},_printVec3:function(t,e){return t+"("+e[0].toPrecision(2)+" "+e[1].toPrecision(2)+" "+e[2].toPrecision(2)+") "}};var At=Object.defineProperty,Et=Object.getOwnPropertySymbols,yt=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable,bt=(t,e,i)=>e in t?At(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,wt=(t,e)=>{for(var i in e||(e={}))yt.call(e,i)&&bt(t,i,e[i]);if(Et)for(var i of Et(e))Pt.call(e,i)&&bt(t,i,e[i]);return t};const Ft=new class{constructor(){this.Core=new t(this),this.VertexBuffer=new e(this),this.GameLoop=new i(this),this.Input=new r,this.ResourceMap=new h,this.TextFileLoader=new l(this),this.DefaultResources=new W(this),this.AudioClips=new u(this),this.Textures=new g(this),this.Fonts=new V(this)}},It=window.innerWidth*window.devicePixelRatio,Bt=window.innerHeight*window.devicePixelRatio;Ft.Core.initializeEngineCore("GLCanvas",new class extends X{constructor(t){super(),this.gEngine=t,this.kMinionSprite="assets/textures/minion_sprite.png",this.kBg="assets/bg.png",this.mCamera=null,this.mBg=null,this.mMsg=null,this.mHero=null,this.mLMinion=null,this.mRMinion=null,this.mGlobalLightSet=null,this.mBlock1=null,this.mBlock2=null,this.mLgtIndex=0,Object.assign(this,wt(wt({},Lt),Rt))}loadScene(){this.gEngine.Textures.loadTexture(this.kMinionSprite),this.gEngine.Textures.loadTexture(this.kBg)}unloadScene(){this.gEngine.Textures.unloadTexture(this.kMinionSprite),this.gEngine.Textures.unloadTexture(this.kBg)}initialize(){this.mCamera=new rt(this.gEngine,y(50,37.5),100,[0,0,window.innerWidth*window.devicePixelRatio,window.innerHeight*window.devicePixelRatio]),this.mCamera.setBackgroundColor([.8,.8,.8,1]),this._initializeLights();var t,e=new pt(this.gEngine,this.kBg);for(e.setElementPixelPositions(0,1024,0,1024),e.getXform().setSize(100,100),e.getXform().setPosition(50,35),t=0;t<4;t++)e.addLight(this.mGlobalLightSet.getLightAt(t));this.mBg=new ut(e),this.mBg.setRenderable(e),this.mHero=new ft(this.gEngine,this.kMinionSprite),this.mHero.getRenderable().addLight(this.mGlobalLightSet.getLightAt(0)),this.mHero.getRenderable().addLight(this.mGlobalLightSet.getLightAt(3)),this.mLMinion=new St(this.gEngine,this.kMinionSprite,17,15),this.mLMinion.getRenderable().addLight(this.mGlobalLightSet.getLightAt(1)),this.mLMinion.getRenderable().addLight(this.mGlobalLightSet.getLightAt(3)),this.mRMinion=new St(this.gEngine,this.kMinionSprite,87,15),this.mRMinion.getRenderable().addLight(this.mGlobalLightSet.getLightAt(2)),this.mRMinion.getRenderable().addLight(this.mGlobalLightSet.getLightAt(3)),this.mMsg=new gt(this.gEngine,"Status Message"),this.mMsg.setColor([1,1,1,1]),this.mMsg.getXform().setPosition(1,2),this.mMsg.setTextHeight(3),this.mBlock1=new ht(this.gEngine),this.mBlock1.setColor([1,0,0,1]),this.mBlock1.getXform().setSize(5,5),this.mBlock1.getXform().setPosition(30,50),this.mBlock2=new ht(this.gEngine),this.mBlock2.setColor([0,1,0,1]),this.mBlock2.getXform().setSize(5,5),this.mBlock2.getXform().setPosition(70,50)}drawCamera(t){t.setupViewProjection(),this.mBg.draw(t),this.mBlock1.draw(t),this.mLMinion.draw(t),this.mBlock2.draw(t),this.mHero.draw(t),this.mRMinion.draw(t)}draw(){this.gEngine.Core.clearCanvas([.9,.9,.9,1]),this.drawCamera(this.mCamera),this.mMsg.draw(this.mCamera)}update(){var t="Selected Light="+this.mLgtIndex+" ";this.mCamera.update(),this.mLMinion.update(),this.mRMinion.update(),this.mHero.update(),t+=this._lightControl(),this.mMsg.setText(t)}}(Ft),It,Bt)})();
//# sourceMappingURL=app.b3dbca3e1d7c666cf63f.js.map